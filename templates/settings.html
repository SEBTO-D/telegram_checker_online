{% extends "base.html" %}{% block content %}
<h3>Настройки</h3>
<form method="post">
  <input type="hidden" name="form" value="cfg">
  <table class="table table-sm"><thead><tr><th>Ключ</th><th>Значение</th></tr></thead><tbody>
  {% for k in keys %}
    <tr>
      <td><code>{{k}}</code></td>
      <td>
        {% set type = 'password' if ('PASS' in k or 'HASH' in k or 'SECRET' in k) else 'text' %}
        <input class="form-control" type="{{type}}" name="{{k}}" value="{{cfg.get(k,'')}}">
      </td>
    </tr>
  {% endfor %}
  </tbody></table>
  <button class="btn btn-primary">Сохранить</button>
</form>

<hr>
<h4>Авторизация Telegram</h4>
{% if stage == 'authorized' %}
  <div class="alert alert-success">Статус: Авторизован ✅</div>
  <form method="post" action="/auth/logout">
    <button class="btn btn-outline-danger">Разлогиниться</button>
  </form>
{% elif stage == 'code' %}
  <div class="alert alert-warning">Статус: Ожидается код из Telegram</div>
  <form method="post" action="/auth/send_code" class="mb-2">
    <button class="btn btn-outline-secondary">Отправить код ещё раз</button>
  </form>
  <form method="post" action="/auth/submit_code" class="row g-2">
    <div class="col-auto"><input class="form-control" name="code" placeholder="Код"></div>
    <div class="col-auto"><button class="btn btn-primary">Подтвердить</button></div>
  </form>
{% elif stage == 'password' %}
  <div class="alert alert-info">Статус: Требуется пароль (2FA)</div>
  <form method="post" action="/auth/submit_password" class="row g-2">
    <div class="col-auto"><input class="form-control" type="password" name="password" placeholder="Пароль"></div>
    <div class="col-auto"><button class="btn btn-primary">Войти</button></div>
  </form>
{% else %}
  <div class="alert alert-secondary">Статус: Не авторизован</div>
  <form method="post" action="/auth/send_code">
    <button class="btn btn-primary">Отправить код</button>
  </form>
{% endif %}
{% endblock %}
